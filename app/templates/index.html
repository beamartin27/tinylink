<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>TinyLink+</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="data:," />
    <!-- avoid extra request from browser for external icon file -->
    <link rel="stylesheet" href="/static/css/index.css" />
  </head>
  <!-- Body: The document's visible content -->
  <body>
    <header>
      <h1>TinyLink+</h1>
      <a class="muted-link" href="/docs" target="_blank">API Docs â†’</a>
    </header>

    <!-- div: global transient UI containers -->
    <div
      id="toast"
      class="toast"
      role="status"
      aria-live="polite"
      style="display: none"
    ></div>
    <div id="errorbar" class="errorbar" style="display: none"></div>

    <!-- Used by JS (enterEditing, exitEditing) to add/remove an editing class which triggers CSS visuals -->
    <div id="formWrap">
      <!-- flex row container (layout only). -->
      <div class="row">
        <input
          id="url"
          class="wide"
          type="url"
          placeholder="https://example.com"
          required
        />
        <!-- browser widget for picking local date+time (no timezone). JS converts to/from ISO UTC with helper functions -->
        <input id="exp" type="datetime-local" required />
        <!-- Buttons trigger JS actions for PUT, LIST...-->
        <button id="createBtn" class="primary" onclick="createLink()">
          Create
        </button>
        <button id="saveBtn" onclick="saveLink()" style="display: none">
          Save
        </button>
        <button class="ghost" onclick="fetchLinks()">Refresh</button>
        <button
          id="autoBtn"
          class="ghost auto-btn off"
          onclick="toggleAutoRefresh()"
        >
          Auto-refresh
        </button>
        <button
          id="cancelBtn"
          class="ghost"
          onclick="cancelEdit()"
          style="display: none"
        >
          Cancel
        </button>
        <span id="status" class="muted"></span>
      </div>
      <div id="editingBanner" class="editing-banner">
        Editing <code id="editingCodeLabel"></code>. Click
        <strong>Save</strong> to confirm or <strong>Cancel</strong> to discard.
      </div>
    </div>

    <!-- shows the list of links -->
    <table id="tbl">
      <!-- able header; holds column headings (one per <th>) -->
      <thead>
        <tr>
          <th>Short</th>
          <th>Target</th>
          <th>Created</th>
          <th>Clicks</th>
          <th>Status / Expires</th>
          <th>QR</th>
          <th>Actions</th>
        </tr>
      </thead>
      <!-- body of the table. JS empties and fills the <tbody> dynamically -->
      <tbody></tbody>
    </table>

    <!-- Details Modal -->
    <dialog id="detailDlg">
      <div class="modal">
        <header><h3 style="margin: 0">Link details</h3></header>
        <main><pre id="detailPre"></pre></main>
        <footer>
          <button class="ghost" onclick="closeDetail()">Close</button>
        </footer>
      </div>
    </dialog>

    <!-- QR Modal -->
    <dialog id="qrDlg">
      <div class="modal">
        <header><h3 style="margin: 0">QR Code</h3></header>
        <main>
          <img
            id="qrImgLarge"
            alt="QR"
            style="
              background: #fff;
              border-radius: 0.5rem;
              max-width: 80vw;
              height: auto;
            "
          />
        </main>
        <footer>
          <button class="ghost" onclick="closeQR()">Close</button>
        </footer>
      </div>
    </dialog>

    <script src="/static/js/index.js"></script>
  </body>
</html>
